<!DOCTYPE html>
<html>
  <head>

    <!-- Version: angular-facebook/Phonegap-facebook-plugin example -->

    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->


    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- libaries -->
    <script src="js/facebookConnectPlugin.js"></script>
    <!--script src="js/facebookConnectPluginCordova.js"></script-->
    <script src="lib/angular-facebook/lib/angular-facebook.js"></script>
    <script src="lib/angular-facebook/lib/angular-facebook-phonegap.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <script src="js/controllers.js"></script>
  </head>

  <body ng-app="starter">


    <div id="app">
      <ion-nav-view></ion-nav-view>
    </div>
    <script>

      if (!window.cordova) {
        //var appId = "341560645995685"; //prompt("Enter FB Application ID", "");
        //facebookConnectPlugin.browserInit(appId);
      };

      window.onload=function(){
        window.addEventListener('FACEBOOK_LOGIN_COMPLETE',
          function(e) {
              alert("index.FACEBOOK_LOGIN_COMPLETE: "+JSON.stringify(e.detail));
            }, false);

        /*
        var event = new CustomEvent(
          "FACEBOOK_LOGIN_COMPLETE",
            {
              detail: {
                message: "Hello World!",
                time: new Date(),
              },
              bubbles: true,
              cancelable: true
              }
            );
        window.dispatchEvent(event);
        */

      };


      window.login = function (errorHandler, sucessHander) {
          //facebookConnectPlugin.login( ["email"],errorHandler, successHandler);
           facebookConnectPlugin.login( ["email"],
              function (response) {
                  //alert("success: "+JSON.stringify(response));
                  var event = new CustomEvent(
                    "FACEBOOK_LOGIN_COMPLETE",
                      {
                        detail: {
                          message: "Hello World!",
                          time: new Date(),
                        },
                        bubbles: true,
                        cancelable: true
                        }
                      );
                  window.dispatchEvent(event);
                },
              function (response) {
                  alert("error: "+JSON.stringify(response))
                  //var eventData = { 'FACEBOOK_LOGIN_COMPLETE' };
                  //var event = new CustomEvent('FACEBOOK_LOGIN_COMPLETE', eventData);
                  //window.dispatchEvent(eventData);
                });
      };

      window.logout = function () {
          facebookConnectPlugin.logout(
              function (response) { alert(JSON.stringify(response)) },
              function (response) { alert(JSON.stringify(response)) });
      };

      window.doAlert = function(msg){
        alert("message:"+msg);
      }

    </script>
  </body>

</html>


